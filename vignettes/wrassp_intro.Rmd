---
title: "An introduction to the wrassp package"
author: "Lasse Bombien & Raphael Winkelmann"
affiliation: "Institute Of Phonetic And Speech Processing (LMU Munich)"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

This document is meant to be an introduction to the `wrassp`
package. `wrassp` is a wrapper to Michel Scheffer's libassp
(Advanced Speech Signal Processor). The libassp library aims at
providing functionality for handling speech signal files in most
common audio formats and for performing analyses common in phonetic
science/speech science. This includes the calculation of formants,
fundamental frequency, root mean square, auto correlation, a variety
of spectral analyses, zero crossing rate, filtering etc. This wrapper
library for R exposes a large subset of the signal processing
functions to R in a (hopefully) user friendly manner.  

Let's get started by locating some example material distributed with
the package.

```{r}
# load the package
library(wrassp)
# some audio files come along with the package
wavpath <- system.file('extdata', package='wrassp')
wavfiles <- list.files(wavpath, pattern=glob2rx('*.wav'), full.names=TRUE)
# now we have some files to play with
```

One of the aims of `wrassp` is to provide mechanisms to handle
speech related files such as sound files and parametric data
files. `wrassp` therefore comes with a class called
`AsspDataObj` which does just that. 


```{r}
# load an audio file, e.g. the first one in the list above
au <- read.AsspDataObj(wavfiles[1])
class(au)
print(au)
```

`au` is an object of the named class and, using `print`, we can get some information on the object, such as it's sampling rate, its duration and what kind of data are stored in what form. Since the file we loaded is audio only, the object contains exactly one track. And since it's a mono file, the track only has one field. We will later encounter different types of data with more than one track and more fields.

There are more ways to extract attributes from the object, such as duration, sampling rate and the number of records:

```{r}
# duration
dur.AsspDataObj(au)
# sampling rate
rate.AsspDataObj(au)
# number of records/samples
numRecs.AsspDataObj(au)
```

An important property of `AsspDataObj` is of course that it
contains data tracks, or at least one data track. As mentioned above,
the currently loaded object contains a single mono audio
track. Accessing the data is easy: `AsspDataObj` stores data in
simple matrices, one matrix for each track. Broadly speaking,
`AsspDataObj` is nothing but a list of at least one matrices. All
of them have the same number of rows (number of records) but each can
have a different number of columns (number of fields). Each track has
a name and we can access the track using that name.

```{r}
tracks.AsspDataObj(au)
#or
names(au)
head(au$audio)
# and we can of course also plot this data (only every tenth element)
plot(au$audio[c(TRUE, rep(FALSE,9))], type='l', ylab='Audio')
```

`wrassp` is of course capable of a lot more than just the mere reading 
of audio files. Next we will use `wrassp` to calculate the formant values,
their corresponding bandwidths, the zero-crossing-rate values and 
the rms-energy values of the audio stored in `wavfiles[1]`.

```{r}
# calculate formants and corresponding bandwidth values
fmvals = forest(wavfiles[1], toFile=F)
# the ToFile=F returns an object of the type AsspDataObj
class(fmvals)
# this time containing muliple tracks (formants + their bandwidths)
tracks.AsspDataObj(fmvals)

# calculate the zero-crossing-rate of the signal
zcrvals = zcrana(wavfiles[1], toFile=F)
# calculate the rms energy of the signal
rmsvals = rmsana(wavfiles[1], toFile=F)

# now plot all of these contours

# plot the formant values
matplot(fmvals$fm, type='l', ylab='formants')
# plot the RMS energy
plot(rmsvals$rms, type='l', ylab='RMS')

```
